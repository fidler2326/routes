var myRoutes=angular.module("myRoutes",["ngRoute"]);myRoutes.config(["$locationProvider","$routeProvider",function(e,t){t.when("/home",{templateUrl:"/app/templates/home/home.html",controller:"HomeController"}).when("/about",{templateUrl:"/app/templates/about/about.html",controller:"AboutController"}).otherwise({redirectTo:"/",templateUrl:"/app/templates/home/home.html",controller:"HomeController"}),e.html5Mode({enabled:!0,requireBase:!1})}]),myRoutes.controller("HomeController",["$rootScope","$scope","$http","$filter","$timeout",function(e,t,o,r,a){t.route_from=null,t.route_to=null,t.my_routes=JSON.parse(localStorage.getItem("my_routes"))||[],t.saved_routes=JSON.parse(localStorage.getItem("saved_routes"))||[],t.id=localStorage.getItem("count")||localStorage.setItem("count",0),t.toggleModal=function(){t.route_name=null,t.route_to=null,t.route_from=null,t.show_modal=!t.show_modal},t.addRoute=function(){t.show_modal=!1,t.updateRoutes("add")},t.deleteRoute=function(e){t.my_routes=JSON.parse(localStorage.getItem("my_routes")),t.my_routes.splice(e,1),localStorage.setItem("my_routes",JSON.stringify(t.my_routes)),t.my_routes=JSON.parse(localStorage.getItem("my_routes")),t.updateRoutes()},t.updateRoutes=function(e){t.show_loading=!0,t.routes=[],"add"==e?t.routes.push({route_name:t.route_name,route_from:t.route_from,route_to:t.route_to}):(localStorage.getItem("saved_routes")&&(localStorage.removeItem("saved_routes"),t.saved_routes=[]),t.routes=t.my_routes),r("empty")(t.routes)&&(t.show_loading=!1),angular.forEach(t.routes,function(o,r){var a=new google.maps.DirectionsService,u={origin:o.route_from,destination:o.route_to,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,drivingOptions:{departureTime:new Date}};a.route(u,function(r,a){"NOT_FOUND"==a?(console.log("ERROR"),t.error={title:"Route Not Found",message:"Route not found! Try to be more specific - add ', UK' to the end of the address and check for spelling mistakes."},t.$apply(),t.saved_routes=JSON.parse(localStorage.getItem("saved_routes"))):(console.log("SUCCESS"),t.show_loading=!1,"add"==e&&(t.my_routes.push({route_name:t.route_name,route_from:t.route_from,route_to:t.route_to}),localStorage.setItem("my_routes",JSON.stringify(t.my_routes)),t.my_routes=JSON.parse(localStorage.getItem("my_routes"))),a==google.maps.DirectionsStatus.OK&&(t.saved_routes.push({route_name:o.route_name,start_address:r.routes[0].legs[0].start_address,end_address:r.routes[0].legs[0].end_address,duration:r.routes[0].legs[0].duration.text,duration_in_traffic:r.routes[0].legs[0].duration_in_traffic.text,duration_class:t.getTime(r.routes[0].legs[0].duration.value,r.routes[0].legs[0].duration_in_traffic.value)}),localStorage.setItem("saved_routes",JSON.stringify(t.saved_routes)),t.saved_routes=JSON.parse(localStorage.getItem("saved_routes")),t.$apply()))})})},t.getTime=function(e,o){return t.duration_class="black",t.duration_class=o<e?"green":"red",t.duration_class}}]),angular.module("myRoutes").directive("routeCard",function(){return{restrict:"E",templateUrl:"../app/templates/home/_route_card.html",scope:!1,controller:["$scope",function(e){}],replace:!0}}).directive("newRouteForm",function(){return{restrict:"E",templateUrl:"../app/templates/home/_form.html",scope:!1,controller:["$scope",function(e){}],replace:!0}}).directive("error",function(){return{restrict:"E",templateUrl:"../app/templates/home/_error.html",scope:!1,controller:["$scope",function(e){e.closeError=function(){e.error=null}}],replace:!0}}).directive("loading",function(){return{restrict:"E",templateUrl:"../app/templates/home/_loading.html",scope:!1,controller:["$scope",function(e){}],replace:!0}}),angular.module("myRoutes").filter("empty",function(){return function(e){try{if(void 0===e||null===e)return!0;if("number"==typeof e||"boolean"==typeof e)return!1;if(void 0!==e.length)return 0==e.length;var t=0;for(var o in e)e.hasOwnProperty(o)&&t++;return 0==t}catch(e){}return!1}});
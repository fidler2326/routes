var myRoutes=angular.module("myRoutes",["ngRoute"]);myRoutes.config(["$locationProvider","$routeProvider",function(e,t){t.when("/home",{templateUrl:"/app/templates/home/home.html",controller:"HomeController"}).when("/about",{templateUrl:"/app/templates/about/about.html",controller:"AboutController"}).otherwise({redirectTo:"/",templateUrl:"/app/templates/home/home.html",controller:"HomeController"}),e.html5Mode({enabled:!0,requireBase:!1})}]),myRoutes.controller("AboutController",["$scope","$http",function(e,t){}]),myRoutes.controller("HomeController",["$scope","$http","$timeout",function(e,t,o){e.route_from=null,e.route_to=null,e.my_routes=JSON.parse(localStorage.getItem("my_routes"))||[],e.saved_routes=JSON.parse(localStorage.getItem("saved_routes"))||[],e.id=localStorage.getItem("count")||localStorage.setItem("count",0),e.toggleModal=function(){e.show_modal=!e.show_modal},e.addRoute=function(){e.show_modal=!1,e.updateRoutes("add")},e.deleteRoute=function(t){e.my_routes=JSON.parse(localStorage.getItem("my_routes")),e.my_routes.splice(t,1),localStorage.setItem("my_routes",JSON.stringify(e.my_routes)),e.my_routes=JSON.parse(localStorage.getItem("my_routes")),e.updateRoutes()},e.updateRoutes=function(t){e.show_loading=!0,e.routes=[],"add"==t?e.routes.push({route_from:e.route_from,route_to:e.route_to}):(localStorage.getItem("saved_routes")&&(localStorage.removeItem("saved_routes"),e.saved_routes=[]),e.routes=e.my_routes),angular.forEach(e.routes,function(o,r){var a=new google.maps.DirectionsService,s={origin:o.route_from,destination:o.route_to,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,drivingOptions:{departureTime:new Date}};a.route(s,function(o,r){"NOT_FOUND"==r?(console.log("ERROR"),e.error="Route not found! Try to be more specific - add ', UK' to the end of the address and check for spelling mistakes.",e.saved_routes=JSON.parse(localStorage.getItem("saved_routes"))):(console.log("SUCCESS"),e.show_loading=!1,"add"==t&&(e.my_routes.push({route_from:e.route_from,route_to:e.route_to}),localStorage.setItem("my_routes",JSON.stringify(e.my_routes)),e.my_routes=JSON.parse(localStorage.getItem("my_routes"))),r==google.maps.DirectionsStatus.OK&&(e.saved_routes.push({start_address:o.routes[0].legs[0].start_address,end_address:o.routes[0].legs[0].end_address,duration:o.routes[0].legs[0].duration.text,duration_in_traffic:o.routes[0].legs[0].duration_in_traffic.text,duration_class:e.getTime(o.routes[0].legs[0].duration.value,o.routes[0].legs[0].duration_in_traffic.value)}),localStorage.setItem("saved_routes",JSON.stringify(e.saved_routes)),e.saved_routes=JSON.parse(localStorage.getItem("saved_routes")),e.$apply()))})})},e.getTime=function(t,o){return e.duration_class="black",e.duration_class=o<t?"green":"red",e.duration_class}}]),angular.module("myRoutes").directive("routeCard",function(){return{restrict:"E",templateUrl:"../app/templates/home/_route_card.html",scope:!1,controller:["$scope",function(e){}],replace:!0}}).directive("newRouteForm",function(){return{restrict:"E",templateUrl:"../app/templates/home/_form.html",scope:!1,controller:["$scope",function(e){}],replace:!0}}),angular.module("myRoutes").filter("empty",function(){return function(e){try{if(void 0===e||null===e)return!0;if("number"==typeof e||"boolean"==typeof e)return!1;if(void 0!==e.length)return 0==e.length;var t=0;for(var o in e)e.hasOwnProperty(o)&&t++;return 0==t}catch(e){}return!1}});